var webApp=function(e){var t=e.module("webApp",["ngRoute","ngResource","ui.bootstrap","toastr"]);return t.config(["$routeProvider","$locationProvider",function(e,t){e.when("/produto",{templateUrl:"partials/produto/index.html",controller:"ProdutoCtrl",controllerAs:"prod",resolve:{produtos:["$rootScope","ProdutoService",function(e,t){return e.activeLoader=!0,t.listar(null,null)}]}}),e.when("/categoria",{templateUrl:"partials/categoria/index.html",controller:"CategoriaCtrl",controllerAs:"cat",resolve:{categorias:["$rootScope","CategoriaService",function(e,t){return e.activeLoader=!0,t.listar(null,null)}]}}),e.otherwise({redirectTo:"/produto"}),t.html5Mode(!0),t.hashPrefix("!")}]),t.run(["$rootScope",function(e){e.activeLoader=!1}]),t}(angular);webApp.constant("constantes",{api:{url:"http://www.webservice.dev/api",path:{produto:"/produto",categoria:"/categoria"}}}),webApp.factory("CategoriaService",["$resource","constantes",function(e,t){var o=t.api.url+t.api.path.categoria;return{listar:function(t){return e(t?t:o).get().$promise},detalhes:function(t){return e(o+"/:id").get({id:t}).$promise},cadastrar:function(t){return e(o).save(t).$promise},atualizar:function(t){return e(o+"/:id",null,{update:{method:"PUT"}}).update({id:t,_method:"PUT"}).$promise},remover:function(t){return e(o+"/:id",null,{delete:{method:"DELETE"}}).delete({id:t,_method:"DELETE"}).$promise}}}]),webApp.factory("ProdutoService",["$resource","constantes",function(e,t){var o=t.api.url+t.api.path.produto;return{listar:function(t,r){return e(t?t:o).get(r).$promise},detalhes:function(t){return e(o+"/:id").get({id:t}).$promise},cadastrar:function(t){return e(o).save(t).$promise},atualizar:function(t){return e(o+"/:id",null,{update:{method:"PUT"}}).update({id:t,_method:"PUT"}).$promise},remover:function(t){return e(o+"/:id",null,{delete:{method:"DELETE"}}).delete({id:t,_method:"DELETE"}).$promise}}}]),webApp.controller("AppCtrl",["$scope","$log",function(e,t){var o=this;o.menuItems=[{path:"/produto",title:"Produto",selected:!1},{path:"/categoria",title:"Categoria",selected:!1}],e.$on("$routeChangeSuccess",function(e,t,r){o.menuItems=o.menuItems.map(function(e){return t.$$route.originalPath==e.path?e.selected=!0:e.selected=!1,e})})}]),webApp.controller("CategoriaCtrl",["$log","$rootScope","$uibModal","categorias","CategoriaService","toastr",function(e,t,o,r,a,n){function i(e){a.listar(e).then(function(e){t.activeLoader=!1,c.proximaPagina=e.next_page_url,c.paginaAnterior=e.prev_page_url,c.categorias=e.data})}t.activeLoader=!1;var c=this;c.proximaPagina=r.next_page_url,c.paginaAnterior=r.prev_page_url,c.categorias=r.data,c.proxima=function(){c.proximaPagina&&(t.activeLoader=!0,i(c.proximaPagina))},c.anterior=function(){c.paginaAnterior&&(t.activeLoader=!0,i(c.paginaAnterior))},c.adicionarNova=function(){var e=o.open({animation:!0,templateUrl:"./partials/categoria/form.html",controller:"CatAdicionarInstanceCtrl",controllerAs:"catAdd",size:"md"});e.result.then(function(){t.activeLoader=!0,i(null,null)})},c.remover=function(e){confirm("Tem certeza que deseja realizar essa ação?")&&a.remover(e.id).then(function(e){n.success(e.msg,"Sucesso"),t.activeLoader=!0,i(null,null)})}}]),webApp.controller("CatAdicionarInstanceCtrl",["$log","$uibModalInstance","CategoriaService","toastr",function(e,t,o,r){var a=this;a.titulo="Adicionar Nova",a.categoria={},a.btnLoading=!1,a.adicionar=function(e){a.btnLoading=!0,o.cadastrar(e).then(function(e){a.btnLoading=!1,a.categoria={},r.success(e.msg,"Sucesso"),t.close()})},a.cancel=function(){t.dismiss("cancel")}}]),webApp.controller("ProdutoCtrl",["$log","$rootScope","$uibModal","produtos","ProdutoService","CategoriaService","toastr",function(e,t,o,r,a,n,i){function c(e,o){a.listar(e,o).then(function(e){t.activeLoader=!1,u.proximaPagina=e.next_page_url,u.paginaAnterior=e.prev_page_url,u.produtos=e.data})}t.activeLoader=!1;var u=this;u.proximaPagina=r.next_page_url,u.paginaAnterior=r.prev_page_url,u.produtos=r.data,u.produto={},u.proxima=function(){u.proximaPagina&&(t.activeLoader=!0,c(u.proximaPagina,u.produto))},u.anterior=function(){u.paginaAnterior&&(t.activeLoader=!0,c(u.paginaAnterior,u.produto))},u.adicionarNovo=function(){var e=o.open({animation:!0,templateUrl:"./partials/produto/form.html",controller:"AdicionarInstanceCtrl",controllerAs:"prodAdd",size:"md",resolve:{categorias:function(){return n.listar()}}});e.result.then(function(){t.activeLoader=!0,c(null,null)})},u.remover=function(e){confirm("Tem certeza que deseja realizar esse ação?")&&a.remover(e.id).then(function(e){i.success(e.msg,"Sucesso"),t.activeLoader=!0,c(null,null)})},u.buscar=function(e){t.activeLoader=!0,c(null,e)}}]),webApp.controller("AdicionarInstanceCtrl",["$log","$uibModalInstance","categorias","ProdutoService","toastr",function(e,t,o,r,a){var n=this;n.titulo="Adicionar Novo",n.produto={},n.categorias=o.data,n.btnLoading=!1,n.selectedCheckbox=function(e){return!!e&&Object.keys(e).some(function(t){return e[t]})},n.adicionar=function(e){n.btnLoading=!0,_categorias=[];for(var o in e.categorias)1==e.categorias[o]&&_categorias.push({categoria_id:o});e.categorias=_categorias,r.cadastrar(e).then(function(e){n.btnLoading=!1,n.produto={},a.success(e.msg,"Sucesso"),t.close()})},n.cancel=function(){t.dismiss("cancel")}}]);