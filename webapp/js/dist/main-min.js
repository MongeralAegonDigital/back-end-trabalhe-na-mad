var webApp=function(t){var r=t.module("webApp",["ngRoute","ngResource","ui.bootstrap","toastr"]);return r.config(["$routeProvider","$locationProvider",function(t,r){t.when("/produto",{templateUrl:"partials/produto/index.html",controller:"ProdutoCtrl",controllerAs:"prod",resolve:{produtos:["$rootScope","ProdutoService",function(t,r){return t.activeLoader=!0,r.listar(null,null)}]}}),t.when("/categoria",{templateUrl:"partials/categoria/index.html",controller:"CategoriaCtrl",controllerAs:"cat",resolve:{categorias:["$rootScope","CategoriaService",function(t,r){return t.activeLoader=!0,r.listar(null,null)}]}}),t.otherwise({redirectTo:"/produto"}),r.html5Mode(!0),r.hashPrefix("!")}]),r.run(["$rootScope",function(t){t.activeLoader=!1}]),r}(angular);webApp.constant("constantes",{api:{url:"http://www.webservice.dev/api",path:{produto:"/produto",categoria:"/categoria"}}}),webApp.factory("CategoriaService",["$resource","constantes",function(t,r){var o=r.api.url+r.api.path.categoria;return{listar:function(r){return t(r?r:o).get().$promise},detalhes:function(r){return t(o+"/:id").get({id:r}).$promise},cadastrar:function(r){return t(o).save(r).$promise},atualizar:function(r){return t(o+"/:id",null,{update:{method:"PUT"}}).update({id:r}).$promise},remover:function(r){return t(o+"/:id",null,{delete:{method:"DELETE"}}).delete({id:r}).$promise}}}]),webApp.factory("ProdutoService",["$resource","constantes",function(t,r){var o=r.api.url+r.api.path.produto;return{listar:function(r,e){return t(r?r:o).get(e).$promise},detalhes:function(r){return t(o+"/:id").get({id:r}).$promise},cadastrar:function(r){return t(o).save(r).$promise},atualizar:function(r){return t(o+"/:id",null,{update:{method:"PUT"}}).update({id:r}).$promise},remover:function(r){return t(o+"/:id",null,{delete:{method:"DELETE"}}).delete({id:r}).$promise}}}]),webApp.controller("AppCtrl",["$scope","$log",function(t,r){var o=this;o.menuItems=[{path:"/produto",title:"Produto",selected:!1},{path:"/categoria",title:"Categoria",selected:!1}],t.$on("$routeChangeSuccess",function(t,r,e){o.menuItems=o.menuItems.map(function(t){return r.$$route.originalPath==t.path?t.selected=!0:t.selected=!1,t})})}]),webApp.controller("CategoriaCtrl",["$log","$rootScope","$uibModal","categorias","CategoriaService",function(t,r,o,e,a){function n(t){a.listar(t).then(function(t){r.activeLoader=!1,i.proximaPagina=t.next_page_url,i.paginaAnterior=t.prev_page_url,i.categorias=t.data})}r.activeLoader=!1;var i=this;i.proximaPagina=e.next_page_url,i.paginaAnterior=e.prev_page_url,i.categorias=e.data,i.proxima=function(){i.proximaPagina&&(r.activeLoader=!0,n(i.proximaPagina))},i.anterior=function(){i.paginaAnterior&&(r.activeLoader=!0,n(i.paginaAnterior))},i.adicionarNova=function(){var t=o.open({animation:!0,templateUrl:"./partials/categoria/form.html",controller:"CatAdicionarInstanceCtrl",controllerAs:"catAdd",size:"md"});t.result.then(function(){r.activeLoader=!0,n(null,null)})}}]),webApp.controller("CatAdicionarInstanceCtrl",["$log","$uibModalInstance","CategoriaService","toastr",function(t,r,o,e){var a=this;a.titulo="Adicionar Nova",a.categoria={},a.btnLoading=!1,a.adicionar=function(t){a.btnLoading=!0,o.cadastrar(t).then(function(t){a.btnLoading=!1,a.categoria={},e.success(t.msg,"Sucesso"),r.close()})},a.cancel=function(){r.dismiss("cancel")}}]),webApp.controller("ProdutoCtrl",["$log","$rootScope","$uibModal","produtos","ProdutoService","CategoriaService",function(t,r,o,e,a,n){function i(t,o){a.listar(t,o).then(function(t){r.activeLoader=!1,c.proximaPagina=t.next_page_url,c.paginaAnterior=t.prev_page_url,c.produtos=t.data})}r.activeLoader=!1;var c=this;c.proximaPagina=e.next_page_url,c.paginaAnterior=e.prev_page_url,c.produtos=e.data,c.produto={},c.proxima=function(){c.proximaPagina&&(r.activeLoader=!0,i(c.proximaPagina,c.produto))},c.anterior=function(){c.paginaAnterior&&(r.activeLoader=!0,i(c.paginaAnterior,c.produto))},c.adicionarNovo=function(){var t=o.open({animation:!0,templateUrl:"./partials/produto/form.html",controller:"AdicionarInstanceCtrl",controllerAs:"prodAdd",size:"md",resolve:{categorias:function(){return n.listar()}}});t.result.then(function(){r.activeLoader=!0,i(null,null)})},c.buscar=function(t){r.activeLoader=!0,i(null,t)}}]),webApp.controller("AdicionarInstanceCtrl",["$log","$uibModalInstance","categorias","ProdutoService","toastr",function(t,r,o,e,a){var n=this;n.titulo="Adicionar Novo",n.produto={},n.categorias=o.data,n.btnLoading=!1,n.selectedCheckbox=function(t){return!!t&&Object.keys(t).some(function(r){return t[r]})},n.adicionar=function(t){n.btnLoading=!0,_categorias=[];for(var o in t.categorias)1==t.categorias[o]&&_categorias.push({categoria_id:o});t.categorias=_categorias,e.cadastrar(t).then(function(t){n.btnLoading=!1,n.produto={},a.success(t.msg,"Sucesso"),r.close()})},n.cancel=function(){r.dismiss("cancel")}}]);